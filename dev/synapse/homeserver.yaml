# Configuration file for Synapse.
#
# This is a YAML file: see [1] for a quick introduction. Note in particular
# that *indentation is important*: all the elements of a list or dictionary
# should have the same indentation.
#
# [1] https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html
#
# For more information on how to configure Synapse, including a complete accounting of
# each option, go to docs/usage/configuration/config_documentation.md or
# https://element-hq.github.io/synapse/latest/usage/configuration/config_documentation.html
server_name: 'matrix.internal'
pid_file: /data/homeserver.pid
listeners:
  - port: 8008
    tls: false
    type: http
    x_forwarded: true
    resources:
      - names: [client, federation]
        compress: false
database:
  name: psycopg2
  args:
    user: postgres
    password: s3cr3t
    dbname: synapse
    host: synapse-db
log_config: '/data/matrix.internal.log.config'
rc_message:
  per_second: 1000
  burst_count: 1000
use_insecure_ssl_client_just_for_testing_do_not_use: true
media_store_path: /data/media_store
registration_shared_secret: 'hPsaGR*yFu__Xg0omA4t^nKe_exYAXh0z&:cxGe8&K,aGi2NJ0'
report_stats: false
macaroon_secret_key: '5fnB8:DR^Kjsf8P1^5+#W7iD&0T~QjlWUQ1Qq31r:E;5WB~#TF'
form_secret: 'Q@5OcThB28ci9M+iOl,CR@sBg~WH3#MN;wsqQf2w1IIU8YuYk-'
signing_key_path:
  '/data/matrix.internal.signing.key'
  #enable_registration: true
  #enable_registration_without_verification: true
trusted_key_servers:
  - server_name: 'matrix.org'

experimental_features:
  msc3861:
    enabled: true

    # Synapse will call `{issuer}/.well-known/openid-configuration` to get the OIDC configuration
    issuer: https://matrix.internal

    # Matches the `client_id` in the auth service config
    client_id: 0000000000000000000SYNAPSE
    # Matches the `client_auth_method` in the auth service config
    client_auth_method: client_secret_basic
    # Matches the `client_secret` in the auth service config
    client_secret: 'XL6sbtX35uF8'

    # Matches the `matrix.secret` in the auth service config
    admin_token: 'o0athzVosHioRx7JDO5DOxi8qH5ToX5s'

    # URL to advertise to clients where users can self-manage their account
    account_management_url: 'https://mas.matrix.internal/account'

enable_authenticated_media: true
